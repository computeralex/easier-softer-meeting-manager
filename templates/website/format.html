{% extends 'website/base_public.html' %}

{% block title %}Meeting Format - {{ meeting_name }}{% endblock %}

{% block extra_styles %}
<style>
    .card-body {
        line-height: 1.5;
    }
    .card-body p {
        margin-bottom: 1.5em;
    }
    .card-body p:last-child {
        margin-bottom: 0;
    }
    .card-body li {
        line-height: 1.5;
        margin-bottom: 0.5em;
    }
    .card-body ul, .card-body ol {
        margin-bottom: 1.5em;
    }
</style>
{% endblock %}

{% block content %}
<div class="content-container">
    <div class="text-center mb-4">
        <h1 class="h3">Meeting Format</h1>
    </div>

    {% if meeting_types %}
    <div class="card mb-4 no-print">
        <div class="card-body py-2">
            <form method="get" class="d-flex align-items-center justify-content-center gap-2 flex-wrap">
                <label class="small text-muted mb-0">Meeting type:</label>
                <select name="type" class="form-select form-select-sm" onchange="this.form.submit()" style="width: auto;">
                    <option value="">Default</option>
                    {% for mt in meeting_types %}
                    <option value="{{ mt.pk }}" {% if preview_type and preview_type.pk == mt.pk %}selected{% endif %}>{{ mt.name }}</option>
                    {% endfor %}
                </select>
                {% if preview_type and preview_type != official_type %}
                <span class="badge bg-warning text-dark">
                    <i class="bi bi-eye me-1"></i>Previewing
                </span>
                {% elif official_type %}
                <span class="badge bg-success">
                    <i class="bi bi-check me-1"></i>{{ official_type.name }}
                </span>
                {% endif %}
            </form>
        </div>
    </div>
    {% endif %}

    {% for item in format_data %}
    <div class="card mb-3">
        <div class="card-header">
            <h5 class="mb-0">{{ item.title }}</h5>
        </div>
        <div class="card-body">
            {% for rc in item.rendered_contents %}
            {{ rc.content|safe }}
            {% endfor %}
        </div>
    </div>
    {% empty %}
    <div class="text-center text-muted py-5">
        <i class="bi bi-file-text display-1"></i>
        <p class="mt-3">No meeting format has been created yet.</p>
    </div>
    {% endfor %}

    {% if format_data %}
    <div class="text-center mt-4 no-print">
        <button onclick="window.print()" class="btn btn-outline-secondary">
            <i class="bi bi-printer me-1"></i> Print
        </button>
    </div>
    {% endif %}
</div>
{% endblock %}
